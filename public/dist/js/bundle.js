!function(g){function I(A){if(C[A])return C[A].exports;var n=C[A]={exports:{},id:A,loaded:!1};return g[A].call(n.exports,n,n.exports,I),n.loaded=!0,n.exports}var C={};return I.m=g,I.c=C,I.p="",I(0)}([function(module,exports,__webpack_require__){eval("var TreeMap = __webpack_require__(1);\n\n(function() {\n    'use strict';\n\n\n    var treeMap = new TreeMap();\n    treeMap.load('/api/lakes/currentLevels');\n}());\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wdWJsaWMvc3JjL2pzL2luZGV4LmpzPzI4YTgiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7QUFDQTs7O0FBR0E7QUFDQTtBQUNBLENBQUMiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBUcmVlTWFwID0gcmVxdWlyZSgnLi90cmVlbWFwJyk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cblxuICAgIHZhciB0cmVlTWFwID0gbmV3IFRyZWVNYXAoKTtcbiAgICB0cmVlTWFwLmxvYWQoJy9hcGkvbGFrZXMvY3VycmVudExldmVscycpO1xufSgpKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9wdWJsaWMvc3JjL2pzL2luZGV4LmpzXG4gKiogbW9kdWxlIGlkID0gMFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports,__webpack_require__){eval("module.exports = (function() {\n    'use strict';\n\n    var BigChart = __webpack_require__(2);\n\n    function TreeMap() {\n      this.bigChart = null;\n\n        this.width = window.innerWidth - 200;\n        this.headerHeight = parseInt(d3.select('#header').style('height'));\n        this.padding = parseInt(d3.select('#background').style('padding-top'));\n        this.padding += parseInt(d3.select('#background').style('padding-bottom'));\n        this.height = window.innerHeight - this.headerHeight - this.padding;\n\n        this.treemap = d3.layout.treemap()\n            .size([this.width, this.height])\n            .sticky(true)\n            .value(function(d) {\n                return d.capacity;\n            });\n\n        this.div = d3.select('#chart')\n            .style('width', this.width + 'px')\n            .style('height', this.height + 'px');\n\n        this.node = null;\n\n        var self = this;\n        d3.select(window).on('resize', function() {\n            self.redraw.apply(self);\n        });\n    }\n\n    TreeMap.prototype.load = function(path) {\n        // Load data\n        this.data = [];\n        var self = this;\n        d3.json(path, function(err, d) {\n            if (err) console.log(err);\n\n            // Do not need overall sytem storage level\n            self.data = d.filter(function(d) {\n                return d.name !== 'System';\n            });\n\n            self.data = {\n                children: self.data\n            };\n\n            self._draw();\n\n        });\n    };\n\n\n    TreeMap.prototype.redraw = function() {\n        this.width = window.innerWidth - 200;\n        this.headerHeight = parseInt(d3.select('#header').style('height'));\n        this.padding = parseInt(d3.select('#background').style('padding-top'));\n        this.padding += parseInt(d3.select('#background').style('padding-bottom'));\n        this.height = window.innerHeight - this.headerHeight - this.padding;\n\n        d3.select('#chart')\n            .style('width', this.width + 'px')\n            .style('height', this.height + 'px');\n\n        this.treemap.size([this.width, this.height]);\n\n        d3.selectAll('.node')\n            .data(this.treemap.nodes)\n            .call(position)\n            .select('.lake-text')\n            .style('font-size', function(d) {\n                return fontSize(d.dx, d.dy);\n            });\n\n        d3.selectAll('.node')\n            .data(this.treemap.nodes)\n            .select('.internal-graph')\n            .call(internalGraph);\n\n        if (this.bigChart) this.bigChart.redraw(this.width, this.height);\n    };\n\n    TreeMap.prototype._draw = function() {\n        var self = this;\n        this.treemap.size([this.width, this.height]);\n\n        this.node = this.div.datum(this.data).selectAll('.node')\n            .data(this.treemap.nodes)\n            .enter().append('div')\n            .attr('class', function(d) {\n                /*** Add in additional data properties. ***/\n                d.percentFull = d.currentLevel / d.capacity;\n                /***/\n                return 'node';\n            })\n            .on('mouseover', function(d) {\n                var e = d3.select(this);\n                e.style('width', function(d) {\n                    return d.dxLarge + 'px';\n                });\n                e.style('left', function(d) {\n                    return (d.x - (d.dxLarge - d.dx) / 2) + 'px';\n                });\n                e.style('height', function(d) {\n                    return d.dyLarge + 'px';\n                });\n                e.style('top', function(d) {\n                    return (d.y - (d.dyLarge - d.dy) / 2) + 'px';\n                });\n\n                e.classed('node-shadow', true);\n\n                e.select('.lake-text').style('font-size', function(d) {\n                    return fontSize(d.dxLarge, d.dyLarge);\n                });\n\n                e.select('.internal-graph')\n                    .style('height', function(d) {\n                        return d.dyLarge * (d.percentFull) + 'px';\n                    })\n                    .style('margin-top', function(d) {\n                        return d.dyLarge * (1 - (d.percentFull)) + 1 + 'px';\n                    });\n            })\n            .on('mouseout', function(d) {\n                var e = d3.select(this);\n                e.call(position);\n                e.classed('node-shadow', false);\n                e.select('.lake-text').style('font-size', function(d) {\n                    return fontSize(d.dx, d.dy);\n                });\n                e.select('.internal-graph')\n                    .style('height', function(d) {\n                        return d.dy * (d.percentFull) + 'px';\n                    })\n                    .style('margin-top', function(d) {\n                        return d.dy * (1 - (d.percentFull)) + 1 + 'px';\n                    });\n            })\n            .on('click', function(d) {\n                // Disable clicking any other nodes\n                self.div.selectAll('.node')\n                  .style('pointer-events', 'none');\n\n                self.bigChart = new BigChart(self.div, d.name, d.capacity);\n                self.bigChart.loadData(\n                    // Graph ready callback\n                    function() {\n                        // Hide all nodes in the treemap chart\n                        self.div.selectAll('.node')\n                          .classed('visible', false)\n                          .classed('hidden', true);\n                    },\n                    // Close callback\n                    function() {\n                        self.div.selectAll('.node')\n                          .classed('hidden', false)\n                          .classed('visible', true)\n                          .style('pointer-events', 'auto');\n                        self.bigChart = null;\n                    });\n            })\n            .call(position);\n\n        this.node.append('div')\n            .attr('class', 'lake-name')\n            .append('span')\n            .attr('class', 'lake-text')\n            .html(function(d) {\n                if (!d.hasOwnProperty('name')) return;\n                return d.name + '<br/>' + Math.round(d.percentFull * 1000) / 10 + '%<br/>' + Math.round(d.currentLevel) + 'GWh';\n            })\n            .style('font-size', function(d) {\n                return fontSize(d.dx, d.dy);\n            });\n\n        this.node.append('div')\n            .attr('class', 'internal-graph')\n            .call(internalGraph);\n    };\n\n    var position = function() {\n        /*jshint -W040*/\n        this.style('left', function(d) {\n                return d.x + 'px';\n            })\n            .style('top', function(d) {\n                return d.y + 'px';\n            })\n            .style('width', function(d) {\n                // dxLarge is the zoomed height\n                d.dxLarge = d.dx * 1.1 > 200 ? d.dx * 1.1 : 200;\n                return Math.max(0, d.dx - 1) + 'px';\n            })\n            .style('height', function(d) {\n                // dyLarge is the zoomed width\n                d.dyLarge = d.dy * 1.1 > 200 ? d.dy * 1.1 : 200;\n                return Math.max(0, d.dy - 1) + 'px';\n            });\n    };\n\n    var fontSize = function(width, height) {\n        return Math.max(14, 0.06 * Math.sqrt(width * height)) + 'px';\n    };\n\n    var internalGraph = function() {\n        /*jshint -W040*/\n        this.style('height', function(d) {\n                return d.dy * (d.percentFull) + 'px';\n            })\n            .style('margin-top', function(d) {\n                return d.dy * (1 - (d.percentFull)) + 'px';\n            });\n    };\n\n\n    return TreeMap;\n\n}());\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wdWJsaWMvc3JjL2pzL3RyZWVtYXAuanM/MGY4MyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxTQUFTO0FBQ1Q7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjs7QUFFQTtBQUNBO0FBQ0EsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCLGFBQWE7QUFDYjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiOzs7QUFHQTs7QUFFQSxDQUFDIiwiZmlsZSI6IjEuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICB2YXIgQmlnQ2hhcnQgPSByZXF1aXJlKCcuL3RyZWVtYXAtYmlnY2hhcnQnKTtcblxuICAgIGZ1bmN0aW9uIFRyZWVNYXAoKSB7XG4gICAgICB0aGlzLmJpZ0NoYXJ0ID0gbnVsbDtcblxuICAgICAgICB0aGlzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGggLSAyMDA7XG4gICAgICAgIHRoaXMuaGVhZGVySGVpZ2h0ID0gcGFyc2VJbnQoZDMuc2VsZWN0KCcjaGVhZGVyJykuc3R5bGUoJ2hlaWdodCcpKTtcbiAgICAgICAgdGhpcy5wYWRkaW5nID0gcGFyc2VJbnQoZDMuc2VsZWN0KCcjYmFja2dyb3VuZCcpLnN0eWxlKCdwYWRkaW5nLXRvcCcpKTtcbiAgICAgICAgdGhpcy5wYWRkaW5nICs9IHBhcnNlSW50KGQzLnNlbGVjdCgnI2JhY2tncm91bmQnKS5zdHlsZSgncGFkZGluZy1ib3R0b20nKSk7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IC0gdGhpcy5oZWFkZXJIZWlnaHQgLSB0aGlzLnBhZGRpbmc7XG5cbiAgICAgICAgdGhpcy50cmVlbWFwID0gZDMubGF5b3V0LnRyZWVtYXAoKVxuICAgICAgICAgICAgLnNpemUoW3RoaXMud2lkdGgsIHRoaXMuaGVpZ2h0XSlcbiAgICAgICAgICAgIC5zdGlja3kodHJ1ZSlcbiAgICAgICAgICAgIC52YWx1ZShmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQuY2FwYWNpdHk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmRpdiA9IGQzLnNlbGVjdCgnI2NoYXJ0JylcbiAgICAgICAgICAgIC5zdHlsZSgnd2lkdGgnLCB0aGlzLndpZHRoICsgJ3B4JylcbiAgICAgICAgICAgIC5zdHlsZSgnaGVpZ2h0JywgdGhpcy5oZWlnaHQgKyAncHgnKTtcblxuICAgICAgICB0aGlzLm5vZGUgPSBudWxsO1xuXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgZDMuc2VsZWN0KHdpbmRvdykub24oJ3Jlc2l6ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VsZi5yZWRyYXcuYXBwbHkoc2VsZik7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIFRyZWVNYXAucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbihwYXRoKSB7XG4gICAgICAgIC8vIExvYWQgZGF0YVxuICAgICAgICB0aGlzLmRhdGEgPSBbXTtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICBkMy5qc29uKHBhdGgsIGZ1bmN0aW9uKGVyciwgZCkge1xuICAgICAgICAgICAgaWYgKGVycikgY29uc29sZS5sb2coZXJyKTtcblxuICAgICAgICAgICAgLy8gRG8gbm90IG5lZWQgb3ZlcmFsbCBzeXRlbSBzdG9yYWdlIGxldmVsXG4gICAgICAgICAgICBzZWxmLmRhdGEgPSBkLmZpbHRlcihmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQubmFtZSAhPT0gJ1N5c3RlbSc7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc2VsZi5kYXRhID0ge1xuICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBzZWxmLmRhdGFcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHNlbGYuX2RyYXcoKTtcblxuICAgICAgICB9KTtcbiAgICB9O1xuXG5cbiAgICBUcmVlTWFwLnByb3RvdHlwZS5yZWRyYXcgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIC0gMjAwO1xuICAgICAgICB0aGlzLmhlYWRlckhlaWdodCA9IHBhcnNlSW50KGQzLnNlbGVjdCgnI2hlYWRlcicpLnN0eWxlKCdoZWlnaHQnKSk7XG4gICAgICAgIHRoaXMucGFkZGluZyA9IHBhcnNlSW50KGQzLnNlbGVjdCgnI2JhY2tncm91bmQnKS5zdHlsZSgncGFkZGluZy10b3AnKSk7XG4gICAgICAgIHRoaXMucGFkZGluZyArPSBwYXJzZUludChkMy5zZWxlY3QoJyNiYWNrZ3JvdW5kJykuc3R5bGUoJ3BhZGRpbmctYm90dG9tJykpO1xuICAgICAgICB0aGlzLmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCAtIHRoaXMuaGVhZGVySGVpZ2h0IC0gdGhpcy5wYWRkaW5nO1xuXG4gICAgICAgIGQzLnNlbGVjdCgnI2NoYXJ0JylcbiAgICAgICAgICAgIC5zdHlsZSgnd2lkdGgnLCB0aGlzLndpZHRoICsgJ3B4JylcbiAgICAgICAgICAgIC5zdHlsZSgnaGVpZ2h0JywgdGhpcy5oZWlnaHQgKyAncHgnKTtcblxuICAgICAgICB0aGlzLnRyZWVtYXAuc2l6ZShbdGhpcy53aWR0aCwgdGhpcy5oZWlnaHRdKTtcblxuICAgICAgICBkMy5zZWxlY3RBbGwoJy5ub2RlJylcbiAgICAgICAgICAgIC5kYXRhKHRoaXMudHJlZW1hcC5ub2RlcylcbiAgICAgICAgICAgIC5jYWxsKHBvc2l0aW9uKVxuICAgICAgICAgICAgLnNlbGVjdCgnLmxha2UtdGV4dCcpXG4gICAgICAgICAgICAuc3R5bGUoJ2ZvbnQtc2l6ZScsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9udFNpemUoZC5keCwgZC5keSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBkMy5zZWxlY3RBbGwoJy5ub2RlJylcbiAgICAgICAgICAgIC5kYXRhKHRoaXMudHJlZW1hcC5ub2RlcylcbiAgICAgICAgICAgIC5zZWxlY3QoJy5pbnRlcm5hbC1ncmFwaCcpXG4gICAgICAgICAgICAuY2FsbChpbnRlcm5hbEdyYXBoKTtcblxuICAgICAgICBpZiAodGhpcy5iaWdDaGFydCkgdGhpcy5iaWdDaGFydC5yZWRyYXcodGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xuICAgIH07XG5cbiAgICBUcmVlTWFwLnByb3RvdHlwZS5fZHJhdyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMudHJlZW1hcC5zaXplKFt0aGlzLndpZHRoLCB0aGlzLmhlaWdodF0pO1xuXG4gICAgICAgIHRoaXMubm9kZSA9IHRoaXMuZGl2LmRhdHVtKHRoaXMuZGF0YSkuc2VsZWN0QWxsKCcubm9kZScpXG4gICAgICAgICAgICAuZGF0YSh0aGlzLnRyZWVtYXAubm9kZXMpXG4gICAgICAgICAgICAuZW50ZXIoKS5hcHBlbmQoJ2RpdicpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgLyoqKiBBZGQgaW4gYWRkaXRpb25hbCBkYXRhIHByb3BlcnRpZXMuICoqKi9cbiAgICAgICAgICAgICAgICBkLnBlcmNlbnRGdWxsID0gZC5jdXJyZW50TGV2ZWwgLyBkLmNhcGFjaXR5O1xuICAgICAgICAgICAgICAgIC8qKiovXG4gICAgICAgICAgICAgICAgcmV0dXJuICdub2RlJztcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICBlLnN0eWxlKCd3aWR0aCcsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuZHhMYXJnZSArICdweCc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZS5zdHlsZSgnbGVmdCcsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChkLnggLSAoZC5keExhcmdlIC0gZC5keCkgLyAyKSArICdweCc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZS5zdHlsZSgnaGVpZ2h0JywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5keUxhcmdlICsgJ3B4JztcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBlLnN0eWxlKCd0b3AnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoZC55IC0gKGQuZHlMYXJnZSAtIGQuZHkpIC8gMikgKyAncHgnO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZS5jbGFzc2VkKCdub2RlLXNoYWRvdycsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgZS5zZWxlY3QoJy5sYWtlLXRleHQnKS5zdHlsZSgnZm9udC1zaXplJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9udFNpemUoZC5keExhcmdlLCBkLmR5TGFyZ2UpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZS5zZWxlY3QoJy5pbnRlcm5hbC1ncmFwaCcpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnaGVpZ2h0JywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuZHlMYXJnZSAqIChkLnBlcmNlbnRGdWxsKSArICdweCc7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnbWFyZ2luLXRvcCcsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLmR5TGFyZ2UgKiAoMSAtIChkLnBlcmNlbnRGdWxsKSkgKyAxICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZSA9IGQzLnNlbGVjdCh0aGlzKTtcbiAgICAgICAgICAgICAgICBlLmNhbGwocG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIGUuY2xhc3NlZCgnbm9kZS1zaGFkb3cnLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgZS5zZWxlY3QoJy5sYWtlLXRleHQnKS5zdHlsZSgnZm9udC1zaXplJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9udFNpemUoZC5keCwgZC5keSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgZS5zZWxlY3QoJy5pbnRlcm5hbC1ncmFwaCcpXG4gICAgICAgICAgICAgICAgICAgIC5zdHlsZSgnaGVpZ2h0JywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGQuZHkgKiAoZC5wZXJjZW50RnVsbCkgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoJ21hcmdpbi10b3AnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5keSAqICgxIC0gKGQucGVyY2VudEZ1bGwpKSArIDEgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub24oJ2NsaWNrJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIC8vIERpc2FibGUgY2xpY2tpbmcgYW55IG90aGVyIG5vZGVzXG4gICAgICAgICAgICAgICAgc2VsZi5kaXYuc2VsZWN0QWxsKCcubm9kZScpXG4gICAgICAgICAgICAgICAgICAuc3R5bGUoJ3BvaW50ZXItZXZlbnRzJywgJ25vbmUnKTtcblxuICAgICAgICAgICAgICAgIHNlbGYuYmlnQ2hhcnQgPSBuZXcgQmlnQ2hhcnQoc2VsZi5kaXYsIGQubmFtZSwgZC5jYXBhY2l0eSk7XG4gICAgICAgICAgICAgICAgc2VsZi5iaWdDaGFydC5sb2FkRGF0YShcbiAgICAgICAgICAgICAgICAgICAgLy8gR3JhcGggcmVhZHkgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBIaWRlIGFsbCBub2RlcyBpbiB0aGUgdHJlZW1hcCBjaGFydFxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kaXYuc2VsZWN0QWxsKCcubm9kZScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKCd2aXNpYmxlJywgZmFsc2UpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5jbGFzc2VkKCdoaWRkZW4nLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmRpdi5zZWxlY3RBbGwoJy5ub2RlJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgLmNsYXNzZWQoJ2hpZGRlbicsIGZhbHNlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAuY2xhc3NlZCgndmlzaWJsZScsIHRydWUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZSgncG9pbnRlci1ldmVudHMnLCAnYXV0bycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5iaWdDaGFydCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYWxsKHBvc2l0aW9uKTtcblxuICAgICAgICB0aGlzLm5vZGUuYXBwZW5kKCdkaXYnKVxuICAgICAgICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xha2UtbmFtZScpXG4gICAgICAgICAgICAuYXBwZW5kKCdzcGFuJylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdsYWtlLXRleHQnKVxuICAgICAgICAgICAgLmh0bWwoZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIGlmICghZC5oYXNPd25Qcm9wZXJ0eSgnbmFtZScpKSByZXR1cm47XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQubmFtZSArICc8YnIvPicgKyBNYXRoLnJvdW5kKGQucGVyY2VudEZ1bGwgKiAxMDAwKSAvIDEwICsgJyU8YnIvPicgKyBNYXRoLnJvdW5kKGQuY3VycmVudExldmVsKSArICdHV2gnO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdHlsZSgnZm9udC1zaXplJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmb250U2l6ZShkLmR4LCBkLmR5KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubm9kZS5hcHBlbmQoJ2RpdicpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnaW50ZXJuYWwtZ3JhcGgnKVxuICAgICAgICAgICAgLmNhbGwoaW50ZXJuYWxHcmFwaCk7XG4gICAgfTtcblxuICAgIHZhciBwb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvKmpzaGludCAtVzA0MCovXG4gICAgICAgIHRoaXMuc3R5bGUoJ2xlZnQnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQueCArICdweCc7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0eWxlKCd0b3AnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQueSArICdweCc7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0eWxlKCd3aWR0aCcsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICAvLyBkeExhcmdlIGlzIHRoZSB6b29tZWQgaGVpZ2h0XG4gICAgICAgICAgICAgICAgZC5keExhcmdlID0gZC5keCAqIDEuMSA+IDIwMCA/IGQuZHggKiAxLjEgOiAyMDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIGQuZHggLSAxKSArICdweCc7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0eWxlKCdoZWlnaHQnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgLy8gZHlMYXJnZSBpcyB0aGUgem9vbWVkIHdpZHRoXG4gICAgICAgICAgICAgICAgZC5keUxhcmdlID0gZC5keSAqIDEuMSA+IDIwMCA/IGQuZHkgKiAxLjEgOiAyMDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1hdGgubWF4KDAsIGQuZHkgLSAxKSArICdweCc7XG4gICAgICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgdmFyIGZvbnRTaXplID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgoMTQsIDAuMDYgKiBNYXRoLnNxcnQod2lkdGggKiBoZWlnaHQpKSArICdweCc7XG4gICAgfTtcblxuICAgIHZhciBpbnRlcm5hbEdyYXBoID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8qanNoaW50IC1XMDQwKi9cbiAgICAgICAgdGhpcy5zdHlsZSgnaGVpZ2h0JywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBkLmR5ICogKGQucGVyY2VudEZ1bGwpICsgJ3B4JztcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3R5bGUoJ21hcmdpbi10b3AnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGQuZHkgKiAoMSAtIChkLnBlcmNlbnRGdWxsKSkgKyAncHgnO1xuICAgICAgICAgICAgfSk7XG4gICAgfTtcblxuXG4gICAgcmV0dXJuIFRyZWVNYXA7XG5cbn0oKSk7XG5cblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vcHVibGljL3NyYy9qcy90cmVlbWFwLmpzXG4gKiogbW9kdWxlIGlkID0gMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports){eval("module.exports = (function() {\n  'use strict';\n    // var d3 = require('d3');\n\n    function BigChart(rootElement, name, capacity) {\n        this.rootElement = rootElement;\n        this.name = name;\n        this.capacity = capacity;\n        this.data = [];\n    }\n\n    BigChart.prototype.loadData = function(callbackReady, callbackClose) {\n        var self = this;\n        this.callbackClose = callbackClose;\n        // Get lake levels\n        d3.json('/api/lakes/levels/' + encodeURIComponent(this.name), function(err, data) {\n            self.data = data;\n            self.createChart();\n            callbackReady();\n        });\n    };\n\n    BigChart.prototype.createChart = function() {\n        var self = this;\n        // Check the number of arguments are ok. Either zero or two.\n        if (arguments.length !== 0 && arguments.length !== 2)\n        {\n          throw new Error(\"Invalid number of arguments. Expected zero or two.\");\n        }\n\n        var width = 0, height = 0;\n        if (arguments.length === 0) {\n          width = this.rootElement.style('width');\n          height = this.rootElement.style('height');\n        } else {\n          width = arguments[0];\n          height = arguments[1];\n        }\n\n        this.rootElement.append('div')\n            .attr('id', 'bigchart')\n            .style('width', width)\n            .style('height', height);\n\n        var margin = 50;\n        var chartWidth = parseInt(width) - 2 * margin;\n        var chartHeight = parseInt(height) - 2 * margin;\n\n        var xScale = d3.time.scale()\n            .range([0, parseInt(chartWidth)])\n            .domain(d3.extent(this.data, function(d) {\n                return new Date(d.date);\n            }));\n\n        var yScale = d3.scale.linear()\n            .range([parseInt(chartHeight), 0])\n            .domain([0, 100]);\n\n        var xAxis = d3.svg.axis()\n            .scale(xScale)\n            .orient('bottom');\n\n        var yAxis = d3.svg.axis()\n            .scale(yScale)\n            .orient('left');\n\n        var svg = d3.select('#bigchart')\n            .append('svg')\n            .attr('width', parseInt(width))\n            .attr('height', parseInt(height))\n            .append('g')\n            .attr('transform', 'translate(' + margin + ', ' + margin + ')');\n\n        var gradient = svg.append('defs')\n            .append('linearGradient')\n            .attr('id', 'blueGradient')\n            .attr('x1', '0')\n            .attr('x2', '0')\n            .attr('y1', '0')\n            .attr('y2', '1');\n\n        gradient.append('stop')\n            .attr('offset', '0%')\n            .attr('stop-color', 'rgba(147, 206, 222, 1)');\n\n        gradient.append('stop')\n            .attr('offset', '41%')\n            .attr('stop-color', 'rgba(117, 189, 209, 1)');\n\n        gradient.append('stop')\n            .attr('offset', '100%')\n            .attr('stop-color', 'rgba(73, 165, 191, 1)');\n\n        var area = d3.svg.area()\n            .x(function(d) {\n                return xScale(new Date(d.date));\n            })\n            .y0(parseInt(chartHeight))\n            .y1(function(d) {\n                return yScale(d.level / self.capacity * 100);\n            });\n\n        svg.append('path')\n            .datum(this.data)\n            .attr('class', 'lake-levels-area')\n            .attr('d', area);\n\n        svg.append('g')\n            .call(xAxis)\n            .attr('class', 'axis')\n            .attr('transform', 'translate(0, ' + chartHeight + ')');\n\n        svg.append('g')\n            .attr('class', 'axis')\n            .call(yAxis)\n            .append('text')\n            .attr('transform', 'rotate(-90)')\n            .attr('y', 10)\n            .attr('dy', '0.7em')\n            .style('text-anchor', 'end')\n            .text('Dam level (%)');\n\n        svg.append('text')\n            .attr('transform', 'translate(' + chartWidth / 2 + ', 0)')\n            .style('text-anchor', 'middle')\n            .attr('font-size', '1.5em')\n            .text(this.name);\n\n        svg.append('text')\n            .attr('transform', 'translate(' + (chartWidth - 50) + ', 0)')\n            .style('text-anchor', 'right')\n            .style('cursor', 'pointer')\n            .text('Close')\n            .on('click', function(d) {\n                self.rootElement.select('#bigchart')\n                    .remove();\n                self.callbackClose();\n            });\n\n    };\n\n    BigChart.prototype.removeChart = function() {\n        this.rootElement.select('#bigchart')\n            .remove();\n    };\n\n    BigChart.prototype.redraw = function(targetWidth, targetHeight) {\n      // Redraws the chart by removing it and creating a new one.\n      // Note that we cannot just read the width and height sytle properties\n      // as they are changing due to CSS transforms. We must pass the final\n      // values to the drawing function manually. Unfortunately we don't get\n      // a nice animation this way....\n\n      this.removeChart();\n      this.createChart(targetWidth, targetHeight);\n    };\n\n    return BigChart;\n\n}());\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wdWJsaWMvc3JjL2pzL3RyZWVtYXAtYmlnY2hhcnQuanM/YTRjNCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhOztBQUViO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7O0FBRWI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxDQUFDIiwiZmlsZSI6IjIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICAgIC8vIHZhciBkMyA9IHJlcXVpcmUoJ2QzJyk7XG5cbiAgICBmdW5jdGlvbiBCaWdDaGFydChyb290RWxlbWVudCwgbmFtZSwgY2FwYWNpdHkpIHtcbiAgICAgICAgdGhpcy5yb290RWxlbWVudCA9IHJvb3RFbGVtZW50O1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmNhcGFjaXR5ID0gY2FwYWNpdHk7XG4gICAgICAgIHRoaXMuZGF0YSA9IFtdO1xuICAgIH1cblxuICAgIEJpZ0NoYXJ0LnByb3RvdHlwZS5sb2FkRGF0YSA9IGZ1bmN0aW9uKGNhbGxiYWNrUmVhZHksIGNhbGxiYWNrQ2xvc2UpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmNhbGxiYWNrQ2xvc2UgPSBjYWxsYmFja0Nsb3NlO1xuICAgICAgICAvLyBHZXQgbGFrZSBsZXZlbHNcbiAgICAgICAgZDMuanNvbignL2FwaS9sYWtlcy9sZXZlbHMvJyArIGVuY29kZVVSSUNvbXBvbmVudCh0aGlzLm5hbWUpLCBmdW5jdGlvbihlcnIsIGRhdGEpIHtcbiAgICAgICAgICAgIHNlbGYuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICBzZWxmLmNyZWF0ZUNoYXJ0KCk7XG4gICAgICAgICAgICBjYWxsYmFja1JlYWR5KCk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBCaWdDaGFydC5wcm90b3R5cGUuY3JlYXRlQ2hhcnQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAvLyBDaGVjayB0aGUgbnVtYmVyIG9mIGFyZ3VtZW50cyBhcmUgb2suIEVpdGhlciB6ZXJvIG9yIHR3by5cbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggIT09IDAgJiYgYXJndW1lbnRzLmxlbmd0aCAhPT0gMilcbiAgICAgICAge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgbnVtYmVyIG9mIGFyZ3VtZW50cy4gRXhwZWN0ZWQgemVybyBvciB0d28uXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHdpZHRoID0gMCwgaGVpZ2h0ID0gMDtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICB3aWR0aCA9IHRoaXMucm9vdEVsZW1lbnQuc3R5bGUoJ3dpZHRoJyk7XG4gICAgICAgICAgaGVpZ2h0ID0gdGhpcy5yb290RWxlbWVudC5zdHlsZSgnaGVpZ2h0Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgd2lkdGggPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgaGVpZ2h0ID0gYXJndW1lbnRzWzFdO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5yb290RWxlbWVudC5hcHBlbmQoJ2RpdicpXG4gICAgICAgICAgICAuYXR0cignaWQnLCAnYmlnY2hhcnQnKVxuICAgICAgICAgICAgLnN0eWxlKCd3aWR0aCcsIHdpZHRoKVxuICAgICAgICAgICAgLnN0eWxlKCdoZWlnaHQnLCBoZWlnaHQpO1xuXG4gICAgICAgIHZhciBtYXJnaW4gPSA1MDtcbiAgICAgICAgdmFyIGNoYXJ0V2lkdGggPSBwYXJzZUludCh3aWR0aCkgLSAyICogbWFyZ2luO1xuICAgICAgICB2YXIgY2hhcnRIZWlnaHQgPSBwYXJzZUludChoZWlnaHQpIC0gMiAqIG1hcmdpbjtcblxuICAgICAgICB2YXIgeFNjYWxlID0gZDMudGltZS5zY2FsZSgpXG4gICAgICAgICAgICAucmFuZ2UoWzAsIHBhcnNlSW50KGNoYXJ0V2lkdGgpXSlcbiAgICAgICAgICAgIC5kb21haW4oZDMuZXh0ZW50KHRoaXMuZGF0YSwgZnVuY3Rpb24oZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShkLmRhdGUpO1xuICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIHZhciB5U2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKVxuICAgICAgICAgICAgLnJhbmdlKFtwYXJzZUludChjaGFydEhlaWdodCksIDBdKVxuICAgICAgICAgICAgLmRvbWFpbihbMCwgMTAwXSk7XG5cbiAgICAgICAgdmFyIHhBeGlzID0gZDMuc3ZnLmF4aXMoKVxuICAgICAgICAgICAgLnNjYWxlKHhTY2FsZSlcbiAgICAgICAgICAgIC5vcmllbnQoJ2JvdHRvbScpO1xuXG4gICAgICAgIHZhciB5QXhpcyA9IGQzLnN2Zy5heGlzKClcbiAgICAgICAgICAgIC5zY2FsZSh5U2NhbGUpXG4gICAgICAgICAgICAub3JpZW50KCdsZWZ0Jyk7XG5cbiAgICAgICAgdmFyIHN2ZyA9IGQzLnNlbGVjdCgnI2JpZ2NoYXJ0JylcbiAgICAgICAgICAgIC5hcHBlbmQoJ3N2ZycpXG4gICAgICAgICAgICAuYXR0cignd2lkdGgnLCBwYXJzZUludCh3aWR0aCkpXG4gICAgICAgICAgICAuYXR0cignaGVpZ2h0JywgcGFyc2VJbnQoaGVpZ2h0KSlcbiAgICAgICAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIG1hcmdpbiArICcsICcgKyBtYXJnaW4gKyAnKScpO1xuXG4gICAgICAgIHZhciBncmFkaWVudCA9IHN2Zy5hcHBlbmQoJ2RlZnMnKVxuICAgICAgICAgICAgLmFwcGVuZCgnbGluZWFyR3JhZGllbnQnKVxuICAgICAgICAgICAgLmF0dHIoJ2lkJywgJ2JsdWVHcmFkaWVudCcpXG4gICAgICAgICAgICAuYXR0cigneDEnLCAnMCcpXG4gICAgICAgICAgICAuYXR0cigneDInLCAnMCcpXG4gICAgICAgICAgICAuYXR0cigneTEnLCAnMCcpXG4gICAgICAgICAgICAuYXR0cigneTInLCAnMScpO1xuXG4gICAgICAgIGdyYWRpZW50LmFwcGVuZCgnc3RvcCcpXG4gICAgICAgICAgICAuYXR0cignb2Zmc2V0JywgJzAlJylcbiAgICAgICAgICAgIC5hdHRyKCdzdG9wLWNvbG9yJywgJ3JnYmEoMTQ3LCAyMDYsIDIyMiwgMSknKTtcblxuICAgICAgICBncmFkaWVudC5hcHBlbmQoJ3N0b3AnKVxuICAgICAgICAgICAgLmF0dHIoJ29mZnNldCcsICc0MSUnKVxuICAgICAgICAgICAgLmF0dHIoJ3N0b3AtY29sb3InLCAncmdiYSgxMTcsIDE4OSwgMjA5LCAxKScpO1xuXG4gICAgICAgIGdyYWRpZW50LmFwcGVuZCgnc3RvcCcpXG4gICAgICAgICAgICAuYXR0cignb2Zmc2V0JywgJzEwMCUnKVxuICAgICAgICAgICAgLmF0dHIoJ3N0b3AtY29sb3InLCAncmdiYSg3MywgMTY1LCAxOTEsIDEpJyk7XG5cbiAgICAgICAgdmFyIGFyZWEgPSBkMy5zdmcuYXJlYSgpXG4gICAgICAgICAgICAueChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHhTY2FsZShuZXcgRGF0ZShkLmRhdGUpKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAueTAocGFyc2VJbnQoY2hhcnRIZWlnaHQpKVxuICAgICAgICAgICAgLnkxKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geVNjYWxlKGQubGV2ZWwgLyBzZWxmLmNhcGFjaXR5ICogMTAwKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHN2Zy5hcHBlbmQoJ3BhdGgnKVxuICAgICAgICAgICAgLmRhdHVtKHRoaXMuZGF0YSlcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdsYWtlLWxldmVscy1hcmVhJylcbiAgICAgICAgICAgIC5hdHRyKCdkJywgYXJlYSk7XG5cbiAgICAgICAgc3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuY2FsbCh4QXhpcylcbiAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsICdheGlzJylcbiAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsICcgKyBjaGFydEhlaWdodCArICcpJyk7XG5cbiAgICAgICAgc3ZnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAuYXR0cignY2xhc3MnLCAnYXhpcycpXG4gICAgICAgICAgICAuY2FsbCh5QXhpcylcbiAgICAgICAgICAgIC5hcHBlbmQoJ3RleHQnKVxuICAgICAgICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICdyb3RhdGUoLTkwKScpXG4gICAgICAgICAgICAuYXR0cigneScsIDEwKVxuICAgICAgICAgICAgLmF0dHIoJ2R5JywgJzAuN2VtJylcbiAgICAgICAgICAgIC5zdHlsZSgndGV4dC1hbmNob3InLCAnZW5kJylcbiAgICAgICAgICAgIC50ZXh0KCdEYW0gbGV2ZWwgKCUpJyk7XG5cbiAgICAgICAgc3ZnLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgY2hhcnRXaWR0aCAvIDIgKyAnLCAwKScpXG4gICAgICAgICAgICAuc3R5bGUoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgICAgICAgICAuYXR0cignZm9udC1zaXplJywgJzEuNWVtJylcbiAgICAgICAgICAgIC50ZXh0KHRoaXMubmFtZSk7XG5cbiAgICAgICAgc3ZnLmFwcGVuZCgndGV4dCcpXG4gICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgKGNoYXJ0V2lkdGggLSA1MCkgKyAnLCAwKScpXG4gICAgICAgICAgICAuc3R5bGUoJ3RleHQtYW5jaG9yJywgJ3JpZ2h0JylcbiAgICAgICAgICAgIC5zdHlsZSgnY3Vyc29yJywgJ3BvaW50ZXInKVxuICAgICAgICAgICAgLnRleHQoJ0Nsb3NlJylcbiAgICAgICAgICAgIC5vbignY2xpY2snLCBmdW5jdGlvbihkKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5yb290RWxlbWVudC5zZWxlY3QoJyNiaWdjaGFydCcpXG4gICAgICAgICAgICAgICAgICAgIC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBzZWxmLmNhbGxiYWNrQ2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgfTtcblxuICAgIEJpZ0NoYXJ0LnByb3RvdHlwZS5yZW1vdmVDaGFydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnJvb3RFbGVtZW50LnNlbGVjdCgnI2JpZ2NoYXJ0JylcbiAgICAgICAgICAgIC5yZW1vdmUoKTtcbiAgICB9O1xuXG4gICAgQmlnQ2hhcnQucHJvdG90eXBlLnJlZHJhdyA9IGZ1bmN0aW9uKHRhcmdldFdpZHRoLCB0YXJnZXRIZWlnaHQpIHtcbiAgICAgIC8vIFJlZHJhd3MgdGhlIGNoYXJ0IGJ5IHJlbW92aW5nIGl0IGFuZCBjcmVhdGluZyBhIG5ldyBvbmUuXG4gICAgICAvLyBOb3RlIHRoYXQgd2UgY2Fubm90IGp1c3QgcmVhZCB0aGUgd2lkdGggYW5kIGhlaWdodCBzeXRsZSBwcm9wZXJ0aWVzXG4gICAgICAvLyBhcyB0aGV5IGFyZSBjaGFuZ2luZyBkdWUgdG8gQ1NTIHRyYW5zZm9ybXMuIFdlIG11c3QgcGFzcyB0aGUgZmluYWxcbiAgICAgIC8vIHZhbHVlcyB0byB0aGUgZHJhd2luZyBmdW5jdGlvbiBtYW51YWxseS4gVW5mb3J0dW5hdGVseSB3ZSBkb24ndCBnZXRcbiAgICAgIC8vIGEgbmljZSBhbmltYXRpb24gdGhpcyB3YXkuLi4uXG5cbiAgICAgIHRoaXMucmVtb3ZlQ2hhcnQoKTtcbiAgICAgIHRoaXMuY3JlYXRlQ2hhcnQodGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCk7XG4gICAgfTtcblxuICAgIHJldHVybiBCaWdDaGFydDtcblxufSgpKTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9wdWJsaWMvc3JjL2pzL3RyZWVtYXAtYmlnY2hhcnQuanNcbiAqKiBtb2R1bGUgaWQgPSAyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9");
}]);